#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Fri Nov 17 14:39:53 2023

@author: mg
"""
import pandas as pd
from tkinter import filedialog

def compare_data_columns(existing_data, new_data):
    #Check if columns match.
    return existing_data.columns.equals(new_data.columns)

def add_new_data_to_dataset(original_data, sep='|'):
    new_file_path = filedialog.askopenfilename(title="Select the new data file", filetypes=[("CSV files", "*.csv")])

    #Return original data if no file is selected.
    if not new_file_path:
        return original_data

    try:
        new_data = pd.read_csv(new_file_path, sep=sep)

        #Ensure the result is a df.
        if compare_data_columns(original_data, new_data):
            combined_data = pd.concat([original_data, new_data], ignore_index=True)
            return combined_data
        else:
            print("Error: Columns of the new data do not match the existing dataset.")
            return original_data

    except FileNotFoundError:
        print(f"File not found: {new_file_path}")
        return original_data
    except Exception as e:
        print(f"An error occurred: {e}")
        return original_data